<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Global Thresholding in Java | Delcastanher's Memory Allocation</title>
<meta name=keywords content="Java"><meta name=description content="Implementing ImageJ Auto Threshold methods in any project."><meta name=author content="Ricardo Delcastanher"><link rel=canonical href=https://delcastanher.github.io/posts/global-thresholding-in-java/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://delcastanher.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://delcastanher.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://delcastanher.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://delcastanher.github.io/apple-touch-icon.png><link rel=mask-icon href=https://delcastanher.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://delcastanher.github.io/posts/global-thresholding-in-java/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Global Thresholding in Java"><meta property="og:description" content="Implementing ImageJ Auto Threshold methods in any project."><meta property="og:type" content="article"><meta property="og:url" content="https://delcastanher.github.io/posts/global-thresholding-in-java/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-30T09:09:40-03:00"><meta property="article:modified_time" content="2022-08-30T09:09:40-03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Global Thresholding in Java"><meta name=twitter:description content="Implementing ImageJ Auto Threshold methods in any project."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://delcastanher.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Global Thresholding in Java","item":"https://delcastanher.github.io/posts/global-thresholding-in-java/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Global Thresholding in Java","name":"Global Thresholding in Java","description":"Implementing ImageJ Auto Threshold methods in any project.","keywords":["Java"],"articleBody":"A global thresholding technique is one which makes use of a single threshold value for the whole image, whereas local thresholding technique makes use of unique threshold values for the partitioned subimages obtained from the whole image. 1\nImageJ Auto Threshold plugin is an open source Java implementation that brings us seventeen global thresholding methods for processing and analyzing scientific images, converting them to black and white.\nTo use them in your project, you will need the histogram of your BufferedImage bufferedImage object, an array with 256 positions (one for each 8 bits color) with the counting of the color occurrence on the original image. 2\nbyte[] pixels = ((DataBufferByte) bufferedImage.getRaster().getDataBuffer()).getData(); int[] histogram = new int[256]; for (int y = 0; y \u003c (bufferedImage.getHeight()); y++) { int i = y * bufferedImage.getWidth(); for (int x = 0; x \u003c (bufferedImage.getWidth()); x++) { int v = pixels[i++] \u0026 0xff; histogram[v]++; } } Copy the Auto Threshold method of your choice from https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java to your project and pass your histogram as a parameter.\nIJDefault Huang Huang2 Intermodes bimodalTest method needed IsoData Li MaxEntropy Mean MinErrorI A, B, and C methods needed Minimum bimodalTest method needed Moments Otsu Percentile partialSum method needed RenyiEntropy Shanbhag Triangle Yen int threshold = IJDefault(histogram); Once you run the method, it will return a threshold value, which you can use on your BufferedImage bufferedImage object, to decide which value is white and which is black.\nfor (int y = 0; y \u003c bufferedImage.getHeight(); y++) { for (int x = 0; x \u003c bufferedImage.getWidth(); x++) { int i = y * bufferedImage.getWidth() + x; if ((pixels[i] \u0026 0xff) \u003e threshold) bufferedImage.setRGB(x, y, Color.WHITE.getRGB()); else bufferedImage.setRGB(x, y, Color.BLACK.getRGB()); } } Now that your image has only white and black values, you can use a TYPE_BYTE_BINARY BufferedImage.\nBufferedImage bwBufferedImage = new BufferedImage(bufferedImage.getWidth(), bufferedImage.getHeight(), BufferedImage.TYPE_BYTE_BINARY); Graphics2D graphics2D = bwBufferedImage.createGraphics(); graphics2D.drawImage(bim, 0, 0, bufferedImage.getWidth(), bufferedImage.getHeight(), null); graphics2D.dispose(); https://www.sciencedirect.com/topics/engineering/global-thresholding ↩︎\nhttps://github.com/imagej/imagej2/blob/7ffb50366de028f4c6e423b3b5fe7fedcb4d678b/src/ij/process/ByteProcessor.java#L1171 ↩︎\n","wordCount":"316","inLanguage":"en","datePublished":"2022-08-30T09:09:40-03:00","dateModified":"2022-08-30T09:09:40-03:00","author":{"@type":"Person","name":"Ricardo Delcastanher"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://delcastanher.github.io/posts/global-thresholding-in-java/"},"publisher":{"@type":"Organization","name":"Delcastanher's Memory Allocation","logo":{"@type":"ImageObject","url":"https://delcastanher.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://delcastanher.github.io/ accesskey=h title="Delcastanher's Memory Allocation (Alt + H)">Delcastanher's Memory Allocation</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Global Thresholding in Java</h1><div class=post-meta><span title='2022-08-30 09:09:40 -0300 -0300'>August 30, 2022</span>&nbsp;·&nbsp;Ricardo Delcastanher</div></header><div class=post-content><p>A global thresholding technique is one which makes use of a single threshold value for the whole image, whereas local thresholding technique makes use of unique threshold values for the partitioned subimages obtained from the whole image. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p><a href=https://imagej.net/plugins/auto-threshold>ImageJ Auto Threshold plugin</a> is an open source Java implementation that brings us seventeen global thresholding methods for processing and analyzing scientific images, <a href=/posts/converting-colors-in-java/>converting them to black and white</a>.</p><p>To use them in your project, you will need the histogram of your <code>BufferedImage bufferedImage</code> object, an array with 256 positions (one for each 8 bits color) with the counting of the color occurrence on the original image. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span><span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> pixels <span style=color:#f92672>=</span> ((DataBufferByte) bufferedImage.<span style=color:#a6e22e>getRaster</span>().<span style=color:#a6e22e>getDataBuffer</span>()).<span style=color:#a6e22e>getData</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> histogram <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>256<span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> 0; y <span style=color:#f92672>&lt;</span> (bufferedImage.<span style=color:#a6e22e>getHeight</span>()); y<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> y <span style=color:#f92672>*</span> bufferedImage.<span style=color:#a6e22e>getWidth</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> 0; x <span style=color:#f92672>&lt;</span> (bufferedImage.<span style=color:#a6e22e>getWidth</span>()); x<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> v <span style=color:#f92672>=</span> pixels<span style=color:#f92672>[</span>i<span style=color:#f92672>++]</span> <span style=color:#f92672>&amp;</span> 0xff;
</span></span><span style=display:flex><span>        histogram<span style=color:#f92672>[</span>v<span style=color:#f92672>]++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Copy the <a href=https://imagej.net/plugins/auto-threshold>Auto Threshold</a> method of your choice from <a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java>https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java</a> to your project and pass your <code>histogram</code> as a parameter.</p><ul><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L409>IJDefault</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L447>Huang</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L533>Huang2</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L603>Intermodes</a><ul><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L586><code>bimodalTest</code></a> method needed</li></ul></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L653>IsoData</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L715>Li</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L797>MaxEntropy</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L882>Mean</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L897>MinErrorI</a><ul><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L945><code>A</code></a>, <a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L952><code>B</code></a>, and <a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L959><code>C</code></a> methods needed</li></ul></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L966>Minimum</a><ul><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L586><code>bimodalTest</code></a> method needed</li></ul></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1017>Moments</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1069>Otsu</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1125>Percentile</a><ul><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1155><code>partialSum</code></a> method needed</li></ul></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1163>RenyiEntropy</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1364>Shanbhag</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1447>Triangle</a></li><li><a href=https://github.com/fiji/Auto_Threshold/blob/master/src/main/java/fiji/threshold/Auto_Threshold.java#L1550>Yen</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span><span style=color:#66d9ef>int</span> threshold <span style=color:#f92672>=</span> IJDefault(histogram);
</span></span></code></pre></div><p>Once you run the method, it will return a <code>threshold</code> value, which you can use on your <code>BufferedImage bufferedImage</code> object, to decide which value is white and which is black.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> 0; y <span style=color:#f92672>&lt;</span> bufferedImage.<span style=color:#a6e22e>getHeight</span>(); y<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> 0; x <span style=color:#f92672>&lt;</span> bufferedImage.<span style=color:#a6e22e>getWidth</span>(); x<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> y <span style=color:#f92672>*</span> bufferedImage.<span style=color:#a6e22e>getWidth</span>() <span style=color:#f92672>+</span> x;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ((pixels<span style=color:#f92672>[</span>i<span style=color:#f92672>]</span> <span style=color:#f92672>&amp;</span> 0xff) <span style=color:#f92672>&gt;</span> threshold)
</span></span><span style=display:flex><span>            bufferedImage.<span style=color:#a6e22e>setRGB</span>(x, y, Color.<span style=color:#a6e22e>WHITE</span>.<span style=color:#a6e22e>getRGB</span>());
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>            bufferedImage.<span style=color:#a6e22e>setRGB</span>(x, y, Color.<span style=color:#a6e22e>BLACK</span>.<span style=color:#a6e22e>getRGB</span>());
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now that your image has only white and black values, you can use a <code>TYPE_BYTE_BINARY</code> <code>BufferedImage</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span>BufferedImage bwBufferedImage <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> BufferedImage(bufferedImage.<span style=color:#a6e22e>getWidth</span>(), bufferedImage.<span style=color:#a6e22e>getHeight</span>(), BufferedImage.<span style=color:#a6e22e>TYPE_BYTE_BINARY</span>);
</span></span><span style=display:flex><span>Graphics2D graphics2D <span style=color:#f92672>=</span> bwBufferedImage.<span style=color:#a6e22e>createGraphics</span>();
</span></span><span style=display:flex><span>graphics2D.<span style=color:#a6e22e>drawImage</span>(bim, 0, 0, bufferedImage.<span style=color:#a6e22e>getWidth</span>(), bufferedImage.<span style=color:#a6e22e>getHeight</span>(), <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>graphics2D.<span style=color:#a6e22e>dispose</span>();
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.sciencedirect.com/topics/engineering/global-thresholding>https://www.sciencedirect.com/topics/engineering/global-thresholding</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://github.com/imagej/imagej2/blob/7ffb50366de028f4c6e423b3b5fe7fedcb4d678b/src/ij/process/ByteProcessor.java#L1171>https://github.com/imagej/imagej2/blob/7ffb50366de028f4c6e423b3b5fe7fedcb4d678b/src/ij/process/ByteProcessor.java#L1171</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://delcastanher.github.io/tags/java/>Java</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://delcastanher.github.io/>Delcastanher's Memory Allocation</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>