<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Setting image DPI in Java AWT Graphics2D | Delcastanher's Memory Allocation</title>
<meta name=keywords content="Java"><meta name=description content="Graphics2D does not have an option to choose images DPI directly."><meta name=author content="Ricardo Delcastanher"><link rel=canonical href=https://delcastanher.github.io/posts/setting-image-dpi-in-java-awt-graphics2d/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://delcastanher.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://delcastanher.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://delcastanher.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://delcastanher.github.io/apple-touch-icon.png><link rel=mask-icon href=https://delcastanher.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Setting image DPI in Java AWT Graphics2D"><meta property="og:description" content="Graphics2D does not have an option to choose images DPI directly."><meta property="og:type" content="article"><meta property="og:url" content="https://delcastanher.github.io/posts/setting-image-dpi-in-java-awt-graphics2d/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-18T16:45:48-03:00"><meta property="article:modified_time" content="2022-07-18T16:45:48-03:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Setting image DPI in Java AWT Graphics2D"><meta name=twitter:description content="Graphics2D does not have an option to choose images DPI directly."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://delcastanher.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Setting image DPI in Java AWT Graphics2D","item":"https://delcastanher.github.io/posts/setting-image-dpi-in-java-awt-graphics2d/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Setting image DPI in Java AWT Graphics2D","name":"Setting image DPI in Java AWT Graphics2D","description":"Graphics2D does not have an option to choose images DPI directly.","keywords":["Java"],"articleBody":"When using Java AWT Graphics2D for creating images in memory, the default image DPI (Dots Per Inch) value is 72. And it has no direct way of choosing or changing this.\nThe scaling of the default transform is set to identity for those devices that are close to 72 dpi, such as screen devices. 1\nTo set an image DPI other than 72, you need to find the relation between the desired DPI and 72 and use it combined with Graphics2D scale method. 2\nApache PDFBox does the first part on method renderImageWithDPI of PDFRenderer class.\npublic BufferedImage renderImageWithDPI(int pageIndex, float dpi) throws IOException { return renderImage(pageIndex, dpi / 72f, ImageType.RGB); } public BufferedImage renderImageWithDPI(int pageIndex, float dpi, ImageType imageType) throws IOException { return renderImage(pageIndex, dpi / 72f, imageType); } The second part is on graphics.scale(scaleX, scaleY); line of the transform method.\nprivate void transform(Graphics2D graphics, int rotationAngle, PDRectangle cropBox, float scaleX, float scaleY) { graphics.scale(scaleX, scaleY); if (rotationAngle != 0) { float translateX = 0; float translateY = 0; switch (rotationAngle) { case 90: translateX = cropBox.getHeight(); break; case 270: translateY = cropBox.getWidth(); break; case 180: translateX = cropBox.getWidth(); translateY = cropBox.getHeight(); break; default: break; } graphics.translate(translateX, translateY); graphics.rotate(Math.toRadians(rotationAngle)); } } https://docs.oracle.com/javase/10/docs/api/java/awt/Graphics2D.html ↩︎\nhttps://community.oracle.com/tech/developers/discussion/comment/5454467/#Comment_5454467 ↩︎\n","wordCount":"204","inLanguage":"en","datePublished":"2022-07-18T16:45:48-03:00","dateModified":"2022-07-18T16:45:48-03:00","author":{"@type":"Person","name":"Ricardo Delcastanher"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://delcastanher.github.io/posts/setting-image-dpi-in-java-awt-graphics2d/"},"publisher":{"@type":"Organization","name":"Delcastanher's Memory Allocation","logo":{"@type":"ImageObject","url":"https://delcastanher.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://delcastanher.github.io/ accesskey=h title="Delcastanher's Memory Allocation (Alt + H)">Delcastanher's Memory Allocation</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Setting image DPI in Java AWT Graphics2D</h1><div class=post-meta><span title='2022-07-18 16:45:48 -0300 -0300'>July 18, 2022</span>&nbsp;·&nbsp;Ricardo Delcastanher</div></header><div class=post-content><p>When using <a href=https://docs.oracle.com/javase/10/docs/api/java/awt/Graphics2D.html>Java AWT Graphics2D</a> for creating images in memory, the default image DPI (Dots Per Inch) value is 72. And it has no direct way of choosing or changing this.</p><blockquote><p><em>The scaling of the default transform is set to identity for those devices that are close to 72 dpi, such as screen devices.</em> <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>To set an image DPI other than 72, you need to find the relation between the desired DPI and 72 and use it combined with Graphics2D <a href=https://docs.oracle.com/javase/10/docs/api/java/awt/Graphics2D.html#scale(double,double)><code>scale</code></a> method. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><p>Apache PDFBox does the first part on method <code>renderImageWithDPI</code> of <a href=https://github.com/apache/pdfbox/blob/trunk/pdfbox/src/main/java/org/apache/pdfbox/rendering/PDFRenderer.java>PDFRenderer class</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span><span style=color:#66d9ef>public</span> BufferedImage <span style=color:#a6e22e>renderImageWithDPI</span>(<span style=color:#66d9ef>int</span> pageIndex, <span style=color:#66d9ef>float</span> dpi) <span style=color:#66d9ef>throws</span> IOException
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> renderImage(pageIndex, dpi <span style=color:#f92672>/</span> 72f, ImageType.<span style=color:#a6e22e>RGB</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> BufferedImage <span style=color:#a6e22e>renderImageWithDPI</span>(<span style=color:#66d9ef>int</span> pageIndex, <span style=color:#66d9ef>float</span> dpi, ImageType imageType) <span style=color:#66d9ef>throws</span> IOException
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> renderImage(pageIndex, dpi <span style=color:#f92672>/</span> 72f, imageType);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The second part is on <code>graphics.scale(scaleX, scaleY);</code> line of the <code>transform</code> method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Java data-lang=Java><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>transform</span>(Graphics2D graphics, <span style=color:#66d9ef>int</span> rotationAngle, PDRectangle cropBox, <span style=color:#66d9ef>float</span> scaleX, <span style=color:#66d9ef>float</span> scaleY)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    graphics.<span style=color:#a6e22e>scale</span>(scaleX, scaleY);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (rotationAngle <span style=color:#f92672>!=</span> 0)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> translateX <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>float</span> translateY <span style=color:#f92672>=</span> 0;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> (rotationAngle)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> 90:
</span></span><span style=display:flex><span>                translateX <span style=color:#f92672>=</span> cropBox.<span style=color:#a6e22e>getHeight</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> 270:
</span></span><span style=display:flex><span>                translateY <span style=color:#f92672>=</span> cropBox.<span style=color:#a6e22e>getWidth</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>case</span> 180:
</span></span><span style=display:flex><span>                translateX <span style=color:#f92672>=</span> cropBox.<span style=color:#a6e22e>getWidth</span>();
</span></span><span style=display:flex><span>                translateY <span style=color:#f92672>=</span> cropBox.<span style=color:#a6e22e>getHeight</span>();
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        graphics.<span style=color:#a6e22e>translate</span>(translateX, translateY);
</span></span><span style=display:flex><span>        graphics.<span style=color:#a6e22e>rotate</span>(Math.<span style=color:#a6e22e>toRadians</span>(rotationAngle));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://docs.oracle.com/javase/10/docs/api/java/awt/Graphics2D.html>https://docs.oracle.com/javase/10/docs/api/java/awt/Graphics2D.html</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://community.oracle.com/tech/developers/discussion/comment/5454467/#Comment_5454467>https://community.oracle.com/tech/developers/discussion/comment/5454467/#Comment_5454467</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://delcastanher.github.io/tags/java/>Java</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://delcastanher.github.io/>Delcastanher's Memory Allocation</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>